<!DOCTYPE html>
<html lang="ko">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>ì„±ê²½ê³ ì‚¬</title>
<style>
  body { font-family: Arial, sans-serif; max-width: 800px; margin: auto; padding: 20px; }
  button { margin: 5px; }
  #home-btn { position: fixed; top: 10px; right: 10px; }
  .hidden { display: none; }
</style>
</head>
<body>

<h1 id="title">ì„±ê²½ê³ ì‚¬</h1>

<div id="home-btn-container">
  <button id="home-btn" class="hidden">ğŸ  í™ˆ</button>
</div>

<div id="menu">
  <button id="practice-btn">ì—°ìŠµë¬¸ì œ</button>
  <button id="mock-btn">ëª¨ì˜ê³ ì‚¬</button>
</div>

<div id="quiz-container" class="hidden">
  <div id="question-number"></div>
  <div id="question-text"></div>
  <div id="choices"></div>
  <button id="prev-btn">ì´ì „ ë¬¸ì œ</button>
  <button id="next-btn">ë‹¤ìŒ ë¬¸ì œ</button>
  <button id="submit-btn" class="hidden">ì œì¶œ</button>
</div>

<div id="result" class="hidden"></div>

<script>
let questions = [];
let currentIndex = 0;
let userAnswers = [];
let totalQuestions = 10; // ëª¨ì˜ê³ ì‚¬ ì„ íƒ ì‹œ ì œí•œ ë¬¸ì œ ìˆ˜

// ë¬¸ì œ ë¶ˆëŸ¬ì˜¤ê¸°
async function loadQuestions() {
  try {
    const res = await fetch('questions/1.txt'); // í…ìŠ¤íŠ¸ íŒŒì¼ ê²½ë¡œ
    if (!res.ok) throw new Error('ë¬¸ì œë¥¼ ë¶ˆëŸ¬ì˜¤ì§€ ëª»í–ˆìŠµë‹ˆë‹¤.');
    const text = await res.text();
    questions = parseQuestions(text);
  } catch (err) {
    alert(err.message);
  }
}

// í…ìŠ¤íŠ¸ -> ë¬¸ì œ ê°ì²´
function parseQuestions(text) {
  const lines = text.split('\n').filter(l => l.trim() !== '');
  const result = [];
  let current = null;
  for (const line of lines) {
    if (/^\d+\.\s/.test(line)) {
      if (current) result.push(current);
      current = { text: line.replace(/^\d+\.\s/, ''), choices: [], answer: null };
    } else if (/^\dë²ˆ:/.test(line)) {
      current.choices.push(line.replace(/^\dë²ˆ:\s*/, ''));
    } else if (/^ë‹µ:/.test(line)) {
      current.answer = line.replace(/^ë‹µ:\s*/, '');
    }
  }
  if (current) result.push(current);
  return result;
}

// ë¬¸ì œ í™”ë©´ í‘œì‹œ
function showQuestion() {
  if (questions.length === 0) return;
  const q = questions[currentIndex];
  document.getElementById('question-number').textContent = `${currentIndex+1} / ${questions.length}`;
  document.getElementById('question-text').textContent = q.text;

  const choicesDiv = document.getElementById('choices');
  choicesDiv.innerHTML = '';
  q.choices.forEach((choice, i) => {
    const btn = document.createElement('button');
    btn.textContent = `${i+1}. ${choice}`;
    btn.style.background = userAnswers[currentIndex] == i+1 ? 'lightgreen' : '';
    btn.onclick = () => {
      userAnswers[currentIndex] = i+1;
      showQuestion();
    };
    choicesDiv.appendChild(btn);
  });
}

// ë²„íŠ¼ ì´ë²¤íŠ¸
document.getElementById('practice-btn').onclick = async () => {
  await loadQuestions();
  totalQuestions = questions.length;
  userAnswers = Array(totalQuestions).fill(null);
  currentIndex = 0;
  document.getElementById('menu').classList.add('hidden');
  document.getElementById('quiz-container').classList.remove('hidden');
  document.getElementById('home-btn').classList.remove('hidden');
  document.getElementById('submit-btn').classList.add('hidden'); // ì—°ìŠµë¬¸ì œëŠ” ì œì¶œ ì—†ìŒ
  showQuestion();
};

document.getElementById('mock-btn').onclick = async () => {
  await loadQuestions();
  totalQuestions = Math.min(60, questions.length); // ëª¨ì˜ê³ ì‚¬ ë¬¸ì œ ìˆ˜ ì œí•œ
  questions = questions.slice(0, totalQuestions);
  userAnswers = Array(totalQuestions).fill(null);
  currentIndex = 0;
  document.getElementById('menu').classList.add('hidden');
  document.getElementById('quiz-container').classList.remove('hidden');
  document.getElementById('home-btn').classList.remove('hidden');
  document.getElementById('submit-btn').classList.remove('hidden'); // ëª¨ì˜ê³ ì‚¬ëŠ” ì œì¶œ
  showQuestion();
};

document.getElementById('prev-btn').onclick = () => {
  if (currentIndex > 0) {
    currentIndex--;
    showQuestion();
  }
};

document.getElementById('next-btn').onclick = () => {
  if (currentIndex < questions.length - 1) {
    currentIndex++;
    showQuestion();
  }
};

document.getElementById('home-btn').onclick = () => {
  document.getElementById('menu').classList.remove('hidden');
  document.getElementById('quiz-container').classList.add('hidden');
  document.getElementById('result').classList.add('hidden');
  document.getElementById('home-btn').classList.add('hidden');
};

document.getElementById('submit-btn').onclick = () => {
  let correct = 0;
  questions.forEach((q, i) => {
    if (userAnswers[i] == parseInt(q.answer)) correct++;
  });
  document.getElementById('result').innerHTML = `ì´ ${questions.length}ë¬¸ì œ ì¤‘ ${correct}ë¬¸ì œ ë§ì•˜ìŠµë‹ˆë‹¤.`;
  document.getElementById('result').classList.remove('hidden');
};
</script>

</body>
</html>
